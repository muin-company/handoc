# TASK-017: DOCX ë³€í™˜ í’ˆì§ˆ ê°œì„  ì™„ë£Œ ë³´ê³ ì„œ

## ğŸ“‹ ì‘ì—… ê°œìš”

**ëª©í‘œ**: docx-writerì™€ docx-readerì—ì„œ í‘œ(table)ì™€ ì´ë¯¸ì§€(image) ë³€í™˜ì„ ì§€ì›í•˜ë„ë¡ ê°œì„ 

**ì‘ì—… ê¸°ê°„**: 2026-02-21  
**ë‹´ë‹¹**: Subagent MJ  
**ìƒíƒœ**: âœ… ì™„ë£Œ

---

## ğŸ¯ ì£¼ìš” ë°œê²¬ì‚¬í•­

### ì´ë¯¸ êµ¬í˜„ë˜ì–´ ìˆì—ˆìŠµë‹ˆë‹¤!

ì¡°ì‚¬ ê²°ê³¼, **í‘œì™€ ì´ë¯¸ì§€ ë³€í™˜ ê¸°ëŠ¥ì€ ì´ë¯¸ ì™„ì „íˆ êµ¬í˜„ë˜ì–´ ìˆì—ˆìŠµë‹ˆë‹¤**:

#### 1. **docx-writer** (`packages/docx-writer/src/converter.ts`)
- âœ… `convertTable()` - HWPX í‘œ â†’ DOCX Table ë³€í™˜ (ì™„ë£Œ)
- âœ… `convertInlineObject()` - HWPX ì´ë¯¸ì§€ â†’ DOCX ImageRun ë³€í™˜ (ì™„ë£Œ)
- âœ… í‘œ ì…€ ë³‘í•©, ë°°ê²½ìƒ‰, í…Œë‘ë¦¬ ì§€ì›
- âœ… ì´ë¯¸ì§€ í¬ê¸°, íƒ€ì… ìë™ ê°ì§€

#### 2. **docx-reader** (`packages/docx-reader/src/docx-parser.ts`)
- âœ… `parseTable()` - DOCX Table â†’ êµ¬ì¡°í™”ëœ íŒŒì‹± (ì™„ë£Œ)
- âœ… `parseDrawingImage()` - DOCX ì´ë¯¸ì§€ â†’ ì¶”ì¶œ ë° íŒŒì‹± (ì™„ë£Œ)
- âœ… í‘œ ì…€ ì†ì„± (gridSpan, vMerge, bgColor, borders) ì™„ì „ ì§€ì›
- âœ… ë‹¤ì¤‘ ì´ë¯¸ì§€ í¬ë§· (PNG, JPEG, GIF, BMP) ì§€ì›

---

## ğŸ“ ì‘ì—… ë‚´ìš©

### 1. í…ŒìŠ¤íŠ¸ ë³´ê°• (ì£¼ìš” ì‘ì—…)

ê¸°ì¡´ êµ¬í˜„ì´ ì™„ì „í–ˆìœ¼ë‚˜, **í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ê°€ ë¶€ì¡±**í–ˆìœ¼ë¯€ë¡œ ì¢…í•© í…ŒìŠ¤íŠ¸ ì¶”ê°€:

#### **docx-writer ì‹ ê·œ í…ŒìŠ¤íŠ¸** (`src/__tests__/table-image-conversion.test.ts`)
- 8ê°œ ì‹ ê·œ í…ŒìŠ¤íŠ¸ ì¶”ê°€
- í‘œ êµ¬ì¡° ë³´ì¡´ ê²€ì¦
- í‘œ ì…€ ë‚´ìš© ë° í¬ë§·íŒ… ê²€ì¦
- ì´ë¯¸ì§€ ì²˜ë¦¬ ê²€ì¦
- Round-trip ë³€í™˜ ê²€ì¦

#### **docx-reader ì‹ ê·œ í…ŒìŠ¤íŠ¸** (`tests/table-image-parsing.test.ts`)
- 13ê°œ ì‹ ê·œ í…ŒìŠ¤íŠ¸ ì¶”ê°€
- ë³µì¡í•œ í‘œ íŒŒì‹± (ë‹¤ì¤‘ í–‰/ì—´)
- ì…€ ë³‘í•© (gridSpan, vMerge)
- ì…€ ë°°ê²½ìƒ‰ ë° í…Œë‘ë¦¬
- ì¸ë¼ì¸ ì´ë¯¸ì§€ íŒŒì‹±
- ì´ë¯¸ì§€ í¬ê¸° ì¶”ì¶œ
- DOCX â†’ HWPX ë³€í™˜

### 2. ì˜ì¡´ì„± ì¶”ê°€

- `fflate` íŒ¨í‚¤ì§€ë¥¼ docx-writer devDependenciesì— ì¶”ê°€ (í…ŒìŠ¤íŠ¸ìš© ZIP íŒŒì‹±)

---

## âœ… ì™„ë£Œ ê¸°ì¤€ ë‹¬ì„±

### Build ì„±ê³µ
```bash
pnpm turbo build --filter='@handoc/docx-writer' --filter='@handoc/docx-reader'
```
- âœ… docx-writer: ë¹Œë“œ ì„±ê³µ
- âœ… docx-reader: ë¹Œë“œ ì„±ê³µ

### Test ì„±ê³µ
```bash
pnpm turbo test --filter='@handoc/docx-writer' --filter='@handoc/docx-reader'
```
- âœ… docx-writer: **14ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼** (ê¸°ì¡´ 6 + ì‹ ê·œ 8)
- âœ… docx-reader: **30ê°œ í…ŒìŠ¤íŠ¸ í†µê³¼** (ê¸°ì¡´ 17 + ì‹ ê·œ 13)

### ê¸°ëŠ¥ ê²€ì¦
- âœ… HWPX â†’ DOCX í‘œ ë³€í™˜ ë™ì‘ í™•ì¸ (`table-basic.hwpx` â†’ DOCX)
- âœ… DOCX â†’ HWPX í‘œ ë³€í™˜ ë™ì‘ í™•ì¸
- âœ… í‘œ ì…€ ë‚´ìš©, ë³‘í•©, ìƒ‰ìƒ, í…Œë‘ë¦¬ ë³´ì¡´
- âœ… ì´ë¯¸ì§€ ì¶”ì¶œ ë° ë³€í™˜ (PNG, JPEG, GIF, BMP)
- âœ… ê¸°ì¡´ í…ŒìŠ¤íŠ¸ ê¹¨ëœ¨ë¦¬ì§€ ì•ŠìŒ

---

## ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½

### ì „ì²´ í…ŒìŠ¤íŠ¸ í†µê³¼ìœ¨: 100%

| íŒ¨í‚¤ì§€ | í…ŒìŠ¤íŠ¸ ìˆ˜ | í†µê³¼ | ì‹¤íŒ¨ | ì¶”ê°€ëœ í…ŒìŠ¤íŠ¸ |
|--------|----------|------|------|-------------|
| docx-writer | 14 | 14 | 0 | +8 |
| docx-reader | 30 | 30 | 0 | +13 |
| **í•©ê³„** | **44** | **44** | **0** | **+21** |

---

## ğŸ” ì½”ë“œ ë³€ê²½ ì‚¬í•­

### ìƒˆë¡œ ì¶”ê°€ëœ íŒŒì¼

1. **`packages/docx-writer/src/__tests__/table-image-conversion.test.ts`**
   - í‘œ/ì´ë¯¸ì§€ ë³€í™˜ í†µí•© í…ŒìŠ¤íŠ¸
   - Round-trip ê²€ì¦
   - 8ê°œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

2. **`packages/docx-reader/tests/table-image-parsing.test.ts`**
   - í‘œ íŒŒì‹± ì¢…í•© í…ŒìŠ¤íŠ¸
   - ì´ë¯¸ì§€ íŒŒì‹± ì¢…í•© í…ŒìŠ¤íŠ¸
   - DOCX â†’ HWPX ë³€í™˜ ê²€ì¦
   - 13ê°œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤

### ìˆ˜ì •ëœ íŒŒì¼

1. **`packages/docx-writer/package.json`**
   - devDependenciesì— `fflate` ì¶”ê°€

---

## ğŸ“ í•™ìŠµ ë‚´ìš©

### 1. dolanmiu/docx ë¼ì´ë¸ŒëŸ¬ë¦¬ í™œìš©
- `Table`, `TableRow`, `TableCell` ì‚¬ìš©ë²•
- `ImageRun` ë³€í™˜ (EMU ë‹¨ìœ„ ì²˜ë¦¬)
- ì…€ ë³‘í•© (`columnSpan`, `rowSpan`)
- ì…€ ì†ì„± (`shading`, `borders`)

### 2. DOCX XML êµ¬ì¡°
- `<w:tbl>` â†’ í‘œ
- `<w:tr>` â†’ í–‰
- `<w:tc>` â†’ ì…€
- `<w:drawing>` â†’ ì´ë¯¸ì§€
- `<a:blip>` â†’ ì´ë¯¸ì§€ ì°¸ì¡°

### 3. HWPX â†’ DOCX ë³€í™˜ íë¦„
```
HWPX (GenericElement)
  â†“
HanDoc Parser (hwpx-parser)
  â†“
Document Model (RunChild 'table'/'inlineObject')
  â†“
docx-writer Converter
  â†“
DOCX (dolanmiu/docx)
```

---

## ğŸ“š í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€

### í‘œ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- [x] ê¸°ë³¸ í‘œ ë³€í™˜ (HWPX â†’ DOCX)
- [x] í‘œ ì…€ ë‚´ìš© ë³´ì¡´
- [x] í‘œ í–‰/ì—´ êµ¬ì¡° ë³´ì¡´
- [x] ì…€ ë³‘í•© (gridSpan, vMerge)
- [x] ì…€ ë°°ê²½ìƒ‰
- [x] ì…€ í…Œë‘ë¦¬ (4ë°©í–¥)
- [x] ì¤‘ì²©ëœ ë‹¨ë½ (ì—¬ëŸ¬ <w:p>)
- [x] DOCX â†’ HWPX ë³€í™˜

### ì´ë¯¸ì§€ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- [x] ì´ë¯¸ì§€ ì¶”ì¶œ (word/media/)
- [x] ì¸ë¼ì¸ ì´ë¯¸ì§€ íŒŒì‹± (<w:drawing>)
- [x] ì´ë¯¸ì§€ í¬ê¸° (extent cx/cy)
- [x] ë‹¤ì¤‘ í¬ë§· (PNG, JPEG, GIF, BMP)
- [x] ì´ë¯¸ì§€ ì—†ëŠ” ë¬¸ì„œ ì²˜ë¦¬
- [x] ì´ë¯¸ì§€ MIME íƒ€ì… ê°ì§€

---

## ğŸš€ ì¶”í›„ ê°œì„  ê°€ëŠ¥ ì‚¬í•­

### 1. ì‹¤ì œ ì´ë¯¸ì§€ í”½ìŠ¤ì²˜ ìƒì„±
í˜„ì¬ `fixtures/hwpx/` ë””ë ‰í† ë¦¬ì— ì´ë¯¸ì§€ê°€ í¬í•¨ëœ HWPX íŒŒì¼ì´ ì—†ìŒ:
- `with-images.hwpx` ìƒì„± í•„ìš”
- `generate_fixtures.py` ìŠ¤í¬ë¦½íŠ¸ í™•ì¥

### 2. ê³ ê¸‰ í‘œ ê¸°ëŠ¥
- í‘œ ìŠ¤íƒ€ì¼ (í—¤ë” í–‰ ê°•ì¡°)
- í‘œ ì •ë ¬ (center, right)
- í‘œ ë„ˆë¹„ ì„¤ì •

### 3. ì´ë¯¸ì§€ ê³ ê¸‰ ê¸°ëŠ¥
- ì´ë¯¸ì§€ íšŒì „
- ì´ë¯¸ì§€ ìë¥´ê¸° (cropping)
- í…ìŠ¤íŠ¸ ë˜í•‘ (text wrapping)

### 4. ì„±ëŠ¥ ìµœì í™”
- ëŒ€ìš©ëŸ‰ í‘œ ì²˜ë¦¬ (1000+ ì…€)
- ë‹¤ì¤‘ ì´ë¯¸ì§€ ë³‘ë ¬ ì²˜ë¦¬

---

## ğŸ“¦ ë³€ê²½ ì‚¬í•­ ìš”ì•½

### ì¶”ê°€ëœ íŒŒì¼
- `packages/docx-writer/src/__tests__/table-image-conversion.test.ts` (+219 lines)
- `packages/docx-reader/tests/table-image-parsing.test.ts` (+390 lines)

### ìˆ˜ì •ëœ íŒŒì¼
- `packages/docx-writer/package.json` (+1 dependency)

### ì½”ë“œ í†µê³„
- ì‹ ê·œ í…ŒìŠ¤íŠ¸: **21ê°œ**
- ì¶”ê°€ëœ ì½”ë“œ: **~600 lines**
- ê¸°ì¡´ ì½”ë“œ ìˆ˜ì •: **0 lines** (ê¸°ì¡´ í…ŒìŠ¤íŠ¸ ìœ ì§€)

---

## ğŸ‰ ê²°ë¡ 

**í‘œì™€ ì´ë¯¸ì§€ ë³€í™˜ ê¸°ëŠ¥ì€ ì´ë¯¸ ì™„ì „íˆ êµ¬í˜„ë˜ì–´ ìˆì—ˆìœ¼ë©°, í…ŒìŠ¤íŠ¸ë¥¼ ì¶”ê°€í•˜ì—¬ í’ˆì§ˆì„ ê²€ì¦í–ˆìŠµë‹ˆë‹¤.**

- âœ… ê¸°ì¡´ êµ¬í˜„ ì™„ì „ì„± í™•ì¸
- âœ… ì¢…í•© í…ŒìŠ¤íŠ¸ 21ê°œ ì¶”ê°€
- âœ… 100% í…ŒìŠ¤íŠ¸ í†µê³¼
- âœ… ê¸°ì¡´ ê¸°ëŠ¥ ë¬´ì†ìƒ
- âœ… Build/Test íŒŒì´í”„ë¼ì¸ í†µê³¼

### ì‘ì—… ì™„ë£Œ í™•ì¸

```bash
# Build í™•ì¸
pnpm turbo build --filter='@handoc/docx-writer' --filter='@handoc/docx-reader'
# âœ… ì„±ê³µ

# Test í™•ì¸
pnpm turbo test --filter='@handoc/docx-writer' --filter='@handoc/docx-reader'
# âœ… 44ê°œ í…ŒìŠ¤íŠ¸ ëª¨ë‘ í†µê³¼

# í‘œ ë³€í™˜ í…ŒìŠ¤íŠ¸
# âœ… table-basic.hwpx â†’ DOCX ë³€í™˜ í™•ì¸
# âœ… DOCX â†’ HWPX ë³€í™˜ í™•ì¸

# ì´ë¯¸ì§€ í…ŒìŠ¤íŠ¸
# âœ… PNG, JPEG, GIF, BMP ì¶”ì¶œ í™•ì¸
# âœ… ì¸ë¼ì¸ ì´ë¯¸ì§€ íŒŒì‹± í™•ì¸
```

---

**ì‘ì—… ì™„ë£Œì¼**: 2026-02-21  
**ìµœì¢… ìƒíƒœ**: âœ… COMPLETE  
**ë‹´ë‹¹**: Subagent MJ (âš¡-handoc-docx-quality)
