# V38 Regression Analysis: v36 (65.3%) → v38 (56.5%)

**분석일:** 2026-02-26  
**비교 대상:** v36 (dafa6d3) vs v38 (179ae87)

## 요약

| 지표 | v36 | v38 | 변화 |
|------|-----|-----|------|
| avg_ssim | — | 0.7233 | — |
| A등급 | 158 | 151 | -7 |
| B등급 | 90 | 69 | -21 |
| C등급 | 124 | 102 | -22 |
| D등급 | 115 | 110 | -5 |
| F등급 | 83 | 138 | **+55** |
| A+B+C (합격) | 372 (65.3%) | 322 (56.5%) | **-50** |

- **퇴보 파일:** 203개
- **개선 파일:** 83개
- **순 퇴보:** 120개 파일

## 핵심 발견: 페이지 수 증가가 주요 원인

퇴보한 203개 파일 중:
- **144개 (71%)**: v38에서 페이지 수 증가 (v36 대비)
- **57개 (28%)**: 페이지 수 동일하나 SSIM 하락
- **2개 (1%)**: 페이지 수 감소

### 페이지 증가 규모
- v36: ref 대비 총 +6 extra pages (거의 정확)
- v38: ref 대비 총 **+401 extra pages**
- 144개 파일 모두에서 v36이 ref에 더 가까움

### D→F 퇴보 (68건) — 전부 페이지 증가
- 가장 심각한 퇴보 그룹
- 68건 중 68건(100%)이 페이지 수 증가

### 페이지 동일 퇴보 (57건)
- 주로 B→C (24건), A→B (17건), C→D (16건)
- SSIM 0.1~0.16 정도 하락
- 렌더링 품질 변화 (이미지/헤더푸터/구분선 관련 추정)

## 커밋별 영향 추정

### 1. `dc4f591` — CJK kinsoku + gifToPng ⚠️ **주요 용의자 #1**
- CJK kinsoku(금칙처리)는 줄 끝에 특정 문자가 오지 못하게 하므로 **줄바꿈이 더 자주 발생** → **페이지 수 증가**
- 71%의 퇴보 파일에서 페이지 증가가 관찰된 것과 정확히 일치
- gifToPng은 부수적 변경

### 2. `cbe92d2` — header/footer + footnote ⚠️ **주요 용의자 #2**
- 헤더/푸터를 새로 렌더링하면 본문 영역이 줄어들어 **페이지 증가** 가능
- 또한 페이지 동일 파일에서도 SSIM 하락 원인 (새로운 요소 추가)
- 57건의 페이지동일-SSIM하락과 관련 가능

### 3. `52a78a4` + `f777d51` — 이미지 렌더링 개선
- 개선 파일 83건 중 다수가 이미지 관련 (F→A, F→B 등)
- 이미지가 없던 파일에 이미지가 추가되면서 **일부 개선, 일부 퇴보** 가능
- 이미지가 커서 페이지 레이아웃에 영향 줄 수 있음

### 4. `18c9e19` — multi-column separator
- 영향 범위 제한적 (다단 문서에만 해당)
- 구분선 추가로 미세한 SSIM 변화 가능

### 5. `179ae87` — empty page removal
- 빈 페이지 제거는 페이지를 **줄이는** 방향
- 개선 파일에서 v38이 ref 페이지에 더 가까운 경우 78/83건 → 이 커밋의 긍정적 효과
- 단, kinsoku가 추가한 extra pages가 빈 페이지로 감지되지 않으므로 상쇄 불가

## 개선된 파일 패턴 (83건)

- 대부분 소규모 파일 (1~3페이지)
- v36에서 페이지 1개 부족 → v38에서 정확한 페이지 수 (empty page removal 또는 이미지 렌더링 개선)
- F→A/B 개선이 많음 (이미지 렌더링 수정 효과)

## Revert 권장사항

### 🔴 즉시 revert 권장: `dc4f591` (CJK kinsoku)
- **근거:** 페이지 수 증가가 퇴보의 71%를 차지하며, kinsoku가 가장 직접적인 원인
- kinsoku 규칙이 너무 공격적이거나 구현에 버그가 있을 가능성
- gifToPng은 분리하여 유지 가능하면 유지

### 🟡 주의하여 테스트: `cbe92d2` (header/footer)
- 페이지동일-SSIM하락 57건의 원인일 수 있음
- revert 후 재측정 필요
- header/footer가 본문 영역을 줄여 페이지 증가에 기여할 수도 있음

### 🟢 유지: `52a78a4`, `f777d51` (이미지 관련)
- 83건 개선의 주요 기여자
- 퇴보 기여도 낮음

### 🟢 유지: `179ae87` (empty page removal)
- 개선 효과 확인됨

### 🟢 유지: `18c9e19` (multi-column separator)
- 영향 미미

## 권장 검증 순서

1. `dc4f591`의 kinsoku 부분만 revert → 재측정
2. 여전히 퇴보 있으면 `cbe92d2` revert → 재측정
3. 각 단계에서 65.3% 회복 여부 확인
