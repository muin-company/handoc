# REVIEW_BY_HEX_v1

- 검토자: HEX
- 검토일: 2026-02-20
- 검토대상: `/Users/wkim/Dropbox/clawd-home/20260220/handoc` 하위 문서/코드
- 검토관점: **AI 에이전트가 사람 개입 없이 자율적으로 구현 가능한가**

---

## 0) 결론 (요약)

현재 문서 세트는 방향성과 과업 분해는 좋지만, **완전 자율 실행(Hands-off) 기준으로는 미흡**합니다.

- 자율 구현 준비도: **56/100 (부분 자율 가능)**
- 가능한 것: HWPX 파서/라이터 범위의 코드 작성, 기본 테스트 작성
- 막히는 것: 환경 재현, 데이터 접근, 품질게이트의 기계 판정, 우선순위 충돌 해소

즉, 지금 상태는 "에이전트가 빨리 코딩하는 문서"는 맞지만, "운영자 없이 끝까지 완수하는 문서"는 아닙니다.

---

## 1) 강점 (자율화에 유리한 점)

1. 작업 분해가 상세함
- `docs/MASTER-PLAN.md`, `docs/EXECUTION-PLAN.md`에 Task 단위/의존성/완료기준이 있음.

2. 타입/패키지 아키텍처가 명확함
- `document-model`, `hwpx-core`, `hwpx-parser`, `hwpx-writer` 경계가 비교적 분명.

3. 검증 지표를 정의하려는 시도
- 텍스트 추출률, 라운드트립, 실제 문서 테스트 등 KPI가 명시됨.

---

## 2) 자율 구현 관점의 핵심 부족점 (치명도 순)

## [CRITICAL-1] 실행 환경이 문서와 실제 런타임에서 불일치

### 증거
- 본 런타임에서 `pnpm` 명령 자체가 없음 (`command not found`).
- 문서는 `pnpm turbo build/test`를 전제로 함.

### 영향
- 에이전트가 코드 수정 후 품질 검증을 스스로 완료할 수 없음.
- "완료" 판정 자동화가 불가.

### 보완
- `bootstrap.sh`/`devcontainer`/`mise` 등으로 **환경 자동 설치 스크립트**를 반드시 제공.
- 최소: Node/pnpm 버전 확인 + 설치 + smoke까지 1명령으로.

---

## [CRITICAL-2] 경로 하드코딩으로 재현성 붕괴

### 증거
- `scripts/test-real-docs.ts`, `scripts/check-zero-text.ts`에 `/Users/mj/...` 하드코딩.
- 문서에도 `/Users/mj/...` 경로가 다수.

### 영향
- 다른 머신/에이전트에서 즉시 실패.
- 완전 자율 수행(다른 노드/컨테이너 포함) 불가능.

### 보완
- 모든 경로를 상대경로 + 환경변수(`HANDOC_FIXTURES_DIR`)로 치환.
- `.env.example` + 런타임 체크(없으면 친절한 에러) 추가.

---

## [CRITICAL-3] 문서 간 기준 충돌 (단일 SoT 부재)

### 증거
- `MASTER-PLAN`: "fixtures 비어있음" 류 기술이 있으나 실제 `fixtures/`는 채워져 있음.
- `real-doc-test-results.md`: 성공률 100%인데 "0 text lines 7"이 동시에 존재.
- 계획서마다 task ID/범위/패키지 수(예: hwp-reader 포함 여부)가 다르게 서술.

### 영향
- 에이전트가 어떤 기준을 정답으로 삼아야 하는지 불명확.
- 자동 의사결정 시 잘못된 목표를 최적화할 위험 큼.

### 보완
- **단일 실행 기준 문서 1개**만 authoritative로 지정.
- 나머지는 아카이브/참고로 명시하고 상태 배지(Active/Superseded) 추가.

---

## [HIGH-1] "완료"를 기계적으로 판정할 수 있는 게이트가 부족

### 증거
- 목표 수치(예: 텍스트 95%)는 있으나, 이를 계산하는 공식 스크립트/입출력 규격이 약함.
- 일부 검증은 수동(한컴오피스 열기) 의존.

### 영향
- 에이전트 자율 루프가 마지막에 사람 확인을 기다리게 됨.

### 보완
- `scripts/quality-gate.ts` 하나로 PASS/FAIL JSON 출력하게 통합.
- 예: `gate.json`에 각 KPI와 임계치, 현재값, 실패원인 기록.

---

## [HIGH-2] 자율 에이전트용 "결정 규칙"이 부족

### 증거
- "3회 실패 시 GenericElement 폴백" 같은 규칙은 있으나, 우선순위 충돌 시 선택 기준이 정량화 안 됨.

### 영향
- 에이전트마다 전략이 달라 결과 일관성 저하.

### 보완
- Decision Policy 명시:
  - 성능 하락 vs 정확도 개선 충돌 시 무엇 우선?
  - TODO 허용 조건?
  - 경고 누적 한계치?

---

## [HIGH-3] 실제 데이터셋 접근 정책이 비어있음

### 증거
- 문서에서 349개 실문서 테스트를 강조하지만 접근 경로/권한 모델이 표준화 안 됨.

### 영향
- 에이전트가 로컬 픽스처만 통과하고 실문서 품질을 보장 못함.

### 보완
- 실문서 테스트셋을 별도 저장소/아티팩트로 표준화하고 접근 토큰/마스킹 정책 정의.

---

## [MEDIUM-1] 패키지 로드맵과 실제 코드 상태 괴리

### 증거
- 계획서에는 `hwp-reader`, `hwp-converter`가 핵심 트랙으로 있으나 현재 `packages/`에는 없음.

### 영향
- 에이전트가 문서상 의존성을 따라가면 즉시 막힘.

### 보완
- "현재 구현된 범위"와 "예정 범위"를 분리 표기.
- 없는 패키지 참조는 TODO 백로그로 이동.

---

## [MEDIUM-2] 운영 로그/리포트 자동 축적 구조 약함

### 증거
- 리포트 md는 있으나, 에이전트 실행 이력을 누적하는 표준 JSONL/SQLite 없음.

### 영향
- 자율 실행 후 회귀 분석/원인 추적 어려움.

### 보완
- `runs/`에 실행 메타데이터 자동 저장 (`run-id`, commit, gate 결과, 실패스택).

---

## 3) "온전 자율 구현"으로 가기 위한 필수 보강안 (우선순위)

## P0 (반드시 먼저)
1. `scripts/bootstrap.sh` 추가 (node/pnpm/toolchain 자동 설치)
2. 경로 하드코딩 제거 (`/Users/mj/...` 전면 제거)
3. Active Plan 1개만 남기고 나머지 `superseded/` 이동
4. `scripts/quality-gate.ts` + `gate.config.json` 도입

## P1
5. 실문서 테스트셋 표준 접근 방식 정의 (env + checksum)
6. Decision Policy 문서화 (충돌 시 우선순위)
7. CI에서 Gate 실패 시 머지 차단

## P2
8. 자율 실행 로그 저장소 (`runs/*.jsonl`) 도입
9. KPI 대시보드 자동 생성

---

## 4) 실행 가능성 재평가 (보강 후)

- 현재: 56/100
- P0 완료 후: **78/100**
- P1까지 완료 후: **88/100**
- P2까지 완료 후: **92/100**

> 95+를 원하면 "한컴오피스 수동 호환성" 영역도 자동화/대체 검증(렌더 스냅샷 비교 등)이 필요.

---

## 5) 즉시 적용 가능한 체크리스트

- [ ] `pnpm` 없는 환경에서도 1커맨드로 세팅 가능
- [ ] 절대경로 0건
- [ ] Active Plan 단일화
- [ ] 품질게이트 자동 PASS/FAIL 산출
- [ ] 실문서 테스트 접근 표준화
- [ ] 에이전트 의사결정 규칙 명시

---

## 최종 코멘트

현재 문서는 "잘 만든 개발 계획"입니다.
하지만 요청하신 수준(에이전트 완전 자율 구현)으로 가려면,
**코드보다 운영 자동화(환경·게이트·데이터·결정규칙) 문서가 먼저 보강되어야 합니다.**
