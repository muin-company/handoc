# 특수 기능

## 개요

한글 프로그램은 수식 편집, 변경 내용 추적, 메모 등 고급 문서 작성에 필요한 특수 기능을 제공합니다.

## 수식 편집기

### 수식 편집기란?
- 수학 공식, 과학 기호를 입력하는 도구
- LaTeX와 유사한 명령어 사용
- 복잡한 수식도 정확하게 표현

### 수식 삽입

#### 접근 방법
1. **메뉴**: `입력 → 수식 → 수식 편집기`
2. **단축키**: `Ctrl + N, M`
3. **빠른 삽입**: `입력 → 수식 → (미리 정의된 수식)`

#### 미리 정의된 수식
- 일반 공식
- 분수/지수
- 도형 (적분, 시그마 등)
- 기타 공식 (이항 정리 등)

### 수식 편집기 UI

#### 화면 구성
1. **수식 표시 창** (상단)
   - 실시간 수식 미리보기
   - WYSIWYG 방식

2. **스크립트 입력 창** (하단)
   - 수식 명령어 입력
   - 텍스트 기반 입력

#### 이동
- **다음 항목**: `Tab`
- **이전 항목**: `Shift + Tab`

#### 닫기
- **단축키**: `Shift + Esc`
- 편집 완료 후 문서에 삽입

### 수식 명령어

#### 기본 기호
- `~`: 빈칸 (스페이스)
- `'`: 빈칸의 1/4
- `{ }`: 여러 항 묶음
- `" "`: 9자 이상 한 낱말 묶음
- `#`: 줄 바꿈 (Enter 효과)
- `&`: 세로 칸 맞춤 (탭 효과)

#### 분수 / 지수
- `OVER`: 분수 (a over b → a/b)
- `ATOP`: 분수선 없는 분수
- `^`: 위첨자 (a^2 → a²)
- `_`: 아래첨자 (a_1 → a₁)

#### 근호
- `SQRT`: 제곱근 (sqrt x → √x)
- `ROOT`: n제곱근 (3 root x → ³√x)

#### 적분 / 합
- `INT`: 적분 (∫)
- `OINT`: 선적분 (∮)
- `SUM`: 시그마 (∑)
- `PROD`: 곱 (∏)

#### 행렬
- `MATRIX`: 행렬
- `PMATRIX`: 괄호 행렬
- `BMATRIX`: 대괄호 행렬

#### 함수
직접 입력 가능 (로만체로 표시):
- sin, cos, tan, log, ln
- lim, max, min, exp
- det, mod, gcd

### 수식 스타일

#### 글꼴
- 기본: HYhwpEQ 또는 HancomEQN
- 이탤릭체 (변수)
- 로만체 (함수명)

#### 크기
- 수식 전체 크기 조절
- 위첨자/아래첨자 자동 축소

### 수식 오류 해결

#### 폰트 문제
- HYhwpEQ 폰트 설치 필요
- HancomEQN 폰트 설치
- 폰트 없으면 깨진 기호 표시

#### 명령어 오류
- 대소문자 구분 (일부 명령어)
- 괄호 짝 맞추기
- 9자 이상은 " " 묶음

## 변경 내용 추적 (Track Changes)

### 변경 추적이란?
- 문서 수정 이력 기록
- 누가, 언제, 무엇을 수정했는지 표시
- 협업 문서 작성에 필수

### 변경 추적 활성화

#### 활성화 방법
1. **메뉴**: `검토 → 변경 내용 추적`
2. **단축키**: `Ctrl + Shift + H`
3. **상태바**: "변경 내용 [기록 중지]" 클릭

#### 상태 표시
- **기록 중지** (초록색): 꺼짐
- **기록 중** (빨간색): 켜짐

### 변경 내용 표시

#### 삽입 내용
- **색상**: 빨간색 (기본)
- **밑줄**: 있음
- 작성자 이름 표시 (툴팁)

#### 삭제 내용
- **색상**: 빨간색
- **취소선**: 있음
- 실제로 삭제되지 않고 표시만

#### 서식 변경
- 파란색 표시 (옵션)

### 변경 내용 검토

#### 변경 사항 탐색
- **다음 변경**: 다음 수정 위치로 이동
- **이전 변경**: 이전 수정 위치로 이동

#### 변경 적용/거부
- **적용**: 변경 사항 확정
- **거부**: 원래대로 복원
- **모두 적용**: 모든 변경 사항 확정
- **모두 거부**: 모든 변경 사항 취소

### 작성자 이름 설정
- `도구 → 환경 설정 → 사용자 정보`
- 작성자 이름 입력
- 변경 추적 시 표시될 이름

### 변경 추적 옵션
- 삽입 색상 변경
- 삭제 색상 변경
- 작성자별 다른 색상
- 날짜/시간 표시

## 메모 (Comment)

### 메모란?
- 문서에 주석 달기
- 협업 시 의견 교환
- 본문에 표시 안 됨 (인쇄 시)

### 메모 삽입

#### 삽입 방법
1. 메모 달 텍스트 선택
2. **메뉴**: `검토 → 새 메모`
3. **단축키**: `Ctrl + Shift + M`
4. 메모 내용 입력

#### 메모 표시
- 선택 영역: 노란색 배경
- 메모 아이콘: 말풍선
- 우측 여백: 메모 내용

### 메모 편집
- 메모 클릭 → 내용 수정
- 메모 삭제: 메모 우클릭 → 삭제

### 메모 탐색
- **다음 메모**: 다음 메모로 이동
- **이전 메모**: 이전 메모로 이동

### 메모 작성자
- 작성자 이름 자동 표시
- 날짜/시간 기록

### 메모 인쇄
- 인쇄 시 메모 포함 여부 선택
- 메모 목록 별도 인쇄 가능

## 책갈피 (Bookmark)

### 책갈피란?
- 문서 내 특정 위치 표시
- 빠른 이동용

### 책갈피 추가
1. 위치 지정
2. `입력 → 책갈피`
3. 책갈피 이름 입력
4. "추가" 클릭

### 책갈피로 이동
- `보기 → 책갈피 찾아가기`
- 책갈피 목록에서 선택 → 이동

### 책갈피 삭제
- 책갈피 대화상자
- 선택 후 "삭제"

## 하이퍼링크 (Hyperlink)

### 하이퍼링크란?
- 다른 문서, 웹페이지로 연결
- 클릭 시 자동 이동

### 하이퍼링크 삽입

#### 삽입 방법
1. 링크 텍스트 선택
2. `입력 → 하이퍼링크`
3. **단축키**: `Ctrl + K`

#### 링크 종류
- **웹 페이지**: URL 입력
- **문서 내 위치**: 책갈피 선택
- **다른 문서**: 파일 경로
- **이메일**: mailto: 링크

### 하이퍼링크 표시
- 파란색 밑줄 (기본)
- 색상 변경 가능

### 하이퍼링크 실행
- `Ctrl + 클릭`으로 이동
- 웹 브라우저, 다른 프로그램 실행

## 숨은 설명 (숨은 글)

### 숨은 설명이란?
- 화면에만 보이고 인쇄 안 됨
- 내부 참고용 메모

### 숨은 설명 삽입
1. 텍스트 선택
2. `서식 → 글자 모양`
3. "숨은 글" 체크

### 숨은 설명 표시
- 화면에 점선 밑줄
- 조판 부호 표시 시에만 보임
- 인쇄 시 제외

## HanDoc 구현 시사점

### Viewer 모드
- 수식 렌더링 (MathML 또는 이미지)
- 변경 추적 표시 (읽기 전용)
- 메모 표시 (팝업 또는 사이드바)
- 하이퍼링크 클릭 동작

### Editor 모드
- 수식 편집기 구현
  - 입력창 + 미리보기
  - 명령어 파서
  - 수식 렌더러 (KaTeX, MathJax)
- 변경 추적 토글
- 메모 삽입/편집 UI
- 책갈피 관리 UI
- 하이퍼링크 편집 대화상자

### 렌더링 최적화
- 수식: KaTeX 또는 MathJax 사용
- 변경 추적: diff 알고리즘
- 메모: 가상 스크롤 (많은 메모)

### 데이터 구조
```typescript
interface Equation {
  script: string; // 수식 명령어
  rendered: string; // HTML or SVG
}

interface TrackedChange {
  id: string;
  type: 'insert' | 'delete' | 'format';
  author: string;
  date: Date;
  content: Content;
  accepted?: boolean;
}

interface Comment {
  id: string;
  author: string;
  date: Date;
  text: string;
  range: Range;
}

interface Bookmark {
  id: string;
  name: string;
  position: number;
}
```

## 참고 자료

- [한글 수식 입력 - 돌팔이 약장수](https://dolpali.tistory.com/154)
- [한글 수식 편집기 사용법](https://giznote.tistory.com/entry/%ED%95%9C%EA%B8%80-%EC%88%98%EC%8B%9D-%EC%9E%85%EB%A0%A5%ED%95%98%EB%8A%94-%EB%B0%A9%EB%B2%95)
- [한글 수식 명령어 - 한컴 도움말](https://help.hancom.com/hoffice/multi/ko_kr/hwp/insert/equation/equation(explanation).htm)
- [한글 변경 내용 추적](https://help.hancom.com/hoffice/multi/ko_kr/hwp/review/track_changes/track_changes.htm)
- [한글 메모 작성자 이름 변경 - 네이버 블로그](https://blog.naver.com/kiosta/222394119324)
- [한글 변경 내용 추적 방법](https://dolpali.tistory.com/255)
