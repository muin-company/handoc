# 표 편집

## 개요

표는 한글 문서에서 가장 많이 사용되는 기능 중 하나입니다. 보고서, 일정표, 데이터 정리 등에 필수적입니다.

## 표 삽입

### 표 삽입 대화상자

#### 접근 방법
- **메뉴**: `입력 → 표 → 표 만들기`
- **단축키**: `Ctrl + N, T`
- **아이콘**: 도구 상자의 표 아이콘

#### 설정 항목
1. **줄 수** (행, Row): 가로줄 개수
2. **칸 수** (열, Column): 세로줄 개수
3. **표 크기**:
   - 쪽 너비에 맞춤 (기본)
   - 사용자 지정 (mm, cm 단위)
4. **표 스타일**: 미리 정의된 표 디자인

#### 빠른 표 삽입
- 표 아이콘 클릭 후 드래그
- 3x3, 5x5 등 빠르게 선택

## 셀 선택

### 선택 방식

#### 1. 마우스 클릭
- **셀 1개**: 클릭
- **여러 셀**: 드래그

#### 2. 키보드 (F5 활용)
- `F5` 1회: 회색 블록 (선택 준비)
- `F5` 2회: 빨간 블록 (선택 모드)
- 빨간 블록 상태에서 방향키로 확장

#### 3. 전체 선택
- 표 왼쪽 상단 모서리 클릭
- `Ctrl + A` (표 안에서)

### 선택 상태 표시
- 선택된 셀: 검정/회색 배경
- 활성 셀: 빨간 동그라미

## 셀 병합 (Merge)

### 병합 방법

#### 방법 1: 마우스 메뉴
1. 병합할 셀들 드래그 선택
2. 우클릭
3. "셀 합치기" 선택

#### 방법 2: 단축키
1. 병합할 셀 선택
2. **단축키**: `M`

### 병합 방향
- 가로 병합
- 세로 병합
- 가로+세로 병합 (여러 셀)

### 병합 후 내용
- 왼쪽 위 셀 내용 유지
- 나머지 셀 내용 삭제됨

## 셀 나누기 (Split)

### 나누기 방법

#### 방법 1: 메뉴
1. 셀 선택
2. 우클릭 → "셀 나누기"
3. 가로/세로 나눔 개수 입력

#### 방법 2: 단축키
1. 셀 선택
2. **단축키**: `S`

### 나누기 옵션
- **가로 나누기**: 행 추가
- **세로 나누기**: 열 추가
- 나눔 개수 지정

## 행/열 추가 및 삭제

### 행(줄) 추가

#### 아래에 행 추가
- 셀 선택 후 우클릭 → "아래에 줄 추가"
- **단축키**: `Ctrl + Enter`

#### 위에 행 추가
- 셀 선택 후 우클릭 → "위에 줄 추가"

### 열(칸) 추가

#### 오른쪽에 열 추가
- 셀 선택 후 우클릭 → "오른쪽에 칸 추가"

#### 왼쪽에 열 추가
- 셀 선택 후 우클릭 → "왼쪽에 칸 추가"

### 행/열 삭제
- 삭제할 행/열 선택
- 우클릭 → "줄 삭제" 또는 "칸 삭제"
- **단축키**: `Ctrl + Delete`

## 셀 크기 조절

### 방법 1: 드래그
- 셀 경계선에 마우스 올리기
- 십자 커서(↔ 또는 ↕) 나타남
- 드래그하여 크기 조절

### 방법 2: 수치 입력
- 표 선택 → 우클릭 → "표 속성"
- "셀 크기" 탭
- 정확한 mm/cm 단위로 입력

### 크기 조절 옵션
- **셀 너비**:
  - 고정 크기
  - 내용에 맞춤
  - 비율로 나누기

- **셀 높이**:
  - 고정 크기
  - 최소 높이
  - 자동 (내용에 따라)

### 전체 표 크기
- 표 선택 → 모서리 핸들 드래그
- 쪽 너비에 맞춤
- 사용자 지정 크기

## 표 테두리

### 테두리 설정

#### 선 종류
- 실선
- 점선
- 이중선
- 물결선
- 사선 (대각선)

#### 선 굵기
- 0.1mm ~ 5mm
- 프리셋: 가는선, 보통, 굵은선

#### 선 색상
- 기본: 검정
- RGB 색상 선택

### 테두리 적용 범위
- **바깥쪽 테두리**: 표 전체 외곽선
- **안쪽 테두리**: 셀 사이 선
- **선택 영역만**: 특정 셀의 특정 테두리

### UI
- 서식 도구 상자: 테두리 아이콘
- 표 우클릭 → "셀 테두리/배경"
- 테두리 미리보기로 시각적 선택

## 셀 배경

### 배경색
- 단색 배경
- RGB 색상 선택
- 투명도 설정

### 그라데이션
- 두 색상 그라데이션
- 방향: 가로, 세로, 대각선

### 무늬
- 줄무늬
- 격자무늬
- 사용자 지정 무늬

### 배경 이미지
- 이미지 파일 삽입
- 크기 조절: 늘이기, 바둑판, 채우기

## 표 안에서 입력

### 셀 이동

#### Tab 키
- `Tab`: 오른쪽 셀로 이동
- `Shift + Tab`: 왼쪽 셀로 이동
- 마지막 셀에서 `Tab`: 새 행 추가

#### 방향키
- 셀 내용 편집 중: 커서 이동
- 빨간 블록 모드: 셀 이동

#### Enter 키
- 셀 내에서 줄 바꿈
- **Ctrl + Enter**: 아래 행 추가

### 셀 내 정렬
- 가로 정렬: 왼쪽/가운데/오른쪽
- 세로 정렬: 위/중간/아래
- **배분 정렬**: 가로/세로 모두 꽉 채움

## 표 스타일

### 미리 정의된 스타일
- 심플
- 모던
- 컬러풀
- 스트라이프
- 공문서 스타일

### 스타일 적용
- 표 선택 → "표 스타일" 선택
- 자동으로 테두리/배경/폰트 적용

### 사용자 지정 스타일
- 직접 디자인 후 스타일로 저장
- 재사용 가능

## 표 특수 기능

### 캡션
- 표 제목 자동 번호 매기기
- 예: "표 1. 연도별 매출"
- 위치: 표 위 또는 아래

### 머리글 반복
- 여러 쪽에 걸친 표
- 첫 행을 다음 쪽에도 반복
- 열 제목 반복에 유용

### 표 나누기
- 긴 표를 여러 쪽으로 분할
- 자동 페이지 나눔

### 표 붙이기
- 인접한 두 표를 하나로 합침
- 행/열 구조 유지

### 셀 계산식
- Excel처럼 간단한 계산
- SUM, AVERAGE 등
- 예: `=SUM(A1:A5)`

## 표 복사/이동

### 복사
- 표 전체 선택 → `Ctrl + C`
- 붙이기: `Ctrl + V`

### 이동
- 표 선택 → 드래그
- 또는 잘라내기(`Ctrl + X`) → 붙이기

## HanDoc 구현 시사점

### Viewer 모드
- 표 렌더링 (테두리, 배경)
- 셀 병합 처리
- 셀 너비/높이 계산
- 배경색/그라데이션 표시

### Editor 모드
- 셀 선택 UI
- 병합/나누기 UI
- 크기 조절 핸들
- 테두리/배경 설정 대화상자
- Tab/Enter 키 동작 구현

### 렌더링 최적화
- 표를 하나의 그리기 개체로 처리
- 셀 단위 렌더링 캐싱
- 큰 표는 가시 영역만 렌더링

### 데이터 구조
```typescript
interface Table {
  rows: number;
  cols: number;
  cells: Cell[][];
  mergedCells: MergedCell[];
  borderStyle: BorderStyle;
}

interface Cell {
  rowSpan: number;
  colSpan: number;
  content: Content;
  border: Border;
  background: Background;
  align: Alignment;
}
```

## 참고 자료

- [한글 표 합치기/셀 병합 - 티스토리](https://calcproject.tistory.com/706)
- [한글 표 쉽게 편집하는 법 - 네이버 블로그](https://m.blog.naver.com/3776air/223787840799)
- [한글 표 만들기 단축키 정리](https://blog.naver.com/gkgkgksms159/223784499834)
- [아래한글 표 만들기 완벽정리](https://oks0998.tistory.com/59)
